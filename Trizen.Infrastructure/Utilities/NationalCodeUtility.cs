using Trizen.Infrastructure.Extensions;

namespace Trizen.Infrastructure.Utilities;

public static class NationalCodeUtility
{
    private static readonly Dictionary<string, string> CityCodes = new()
    {
       {"001", "تهران مرکزی"},
        {"002", "تهران مرکزی"},
        {"003", "تهران مرکزی"},
        {"004", "تهران مرکزی"},
        {"005", "تهران مرکزی"},
        {"006", "تهران مرکزی"},
        {"007", "تهران مرکزی"},
        {"008", "تهران مرکزی"},
        {"011", "تهران جنوب"},
        {"015", "تهران غرب"},
        {"020", "تهران شرق"},
        {"025", "تهرانشمال"},
        {"031", "کرج"},
        {"032", "کرج"},
        {"037", "قم"},
        {"038", "قم"},
        {"041", "ورامین"},
        {"042", "ورامین"},
        {"043", "دماوند"},
        {"044", "شمیران"},
        {"045", "شمیران"},
        {"048", "شهرری"},
        {"049", "شهرری"},
        {"051", "آشتیان"},
        {"052", "اراک"},
        {"053", "اراک"},
        {"055", "خمین"},
        {"056", "محلات"},
        {"057", "دلیجان"},
        {"058", "تفرش"},
        {"059", "ساوه"},
        {"060", "ساوه"},
        {"061", "سربند"},
        {"062", "سربند"},
        {"063", "اسفراین"},
        {"064", "بیرجند"},
        {"065", "بیرجند"},
        {"067", "بجنورد"},
        {"068", "بجنورد"},
        {"069", "تربت حیدریه"},
        {"070", "تربت حیدریه"},
        {"072", "تربت جام"},
        {"073", "تربت جام"},
        {"074", "تایباد"},
        {"075", "جاجرم"},
        {"076", "خواف"},
        {"077", "درگز"},
        {"078", "سبزوار"},
        {"079", "سبزوار"},
        {"081", "سرخس"},
        {"082", "شیروان"},
        {"084", "فریمان"},
        {"083", "طبس"},
        {"085", "فردوس"},
        {"086", "قوچان"},
        {"087", "قوچان"},
        {"088", "قائنات"},
        {"089", "کاشمر"},
        {"090", "کاشمر"},
        {"091", "گناباد"},
        {"092", "مشهد"},
        {"093", "مشهد"},
        {"094", "مشهد"},
        {"096", "مشهد منطقه1"},
        {"097", "مشهد منطقه2"},
        {"098", "مشهد منطقه3"},
        {"105", "نیشابور"},
        {"106", "نیشابور"},
        {"108", "نجف آباد"},
        {"109", "نجف آباد"},
        {"110", "فلاورجان"},
        {"111", "فلاورجان"},
        {"112", "فریدونشهر"},
        {"113", "خمینی شهر"},
        {"114", "خمینی شهر"},
        {"115", "فریدن"},
        {"116", "لنجان(زرینشهر)"},
        {"117", "لنجان(زرینشهر)"},
        {"118", "اردستان"},
        {"119", "شهرضا"},
        {"120", "سمیرم"},
        {"121", "گلپایگان"},
        {"122", "خوانسار"},
        {"123", "نطنز"},
        {"124", "نائین"},
        {"125", "کاشان"},
        {"126", "کاشان"},
        {"127", "اصفهان"},
        {"128", "اصفهان"},
        {"129", "اصفهان"},
        {"136", "تبریز"},
        {"137", "تبریز"},
        {"138", "تبریز"},
        {"145", "اردبیل"},
        {"146", "اردبیل"},
        {"149", "اهر"},
        {"150", "اهر"},
        {"152", "میانه"},
        {"153", "میانه"},
        {"154", "مراغه"},
        {"155", "مراغه"},
        {"157", "مرند"},
        {"159", "هشترود"},
        {"160", "هشترود"},
        {"161", "مغان"},
        {"162", "مغان"},
        {"163", "خلخال"},
        {"164", "سراب"},
        {"165", "سراب"},
        {"166", "مشکین شهر"},
        {"167", "مشکین شهر"},
        {"168", "بناب"},
        {"169", "آذرشهر"},
        {"170", "اسکو"},
        {"171", "بستان آباد"},
        {"172", "شبستر"},
        {"173", "هریس"},
        {"174", "اهواز"},
        {"175", "اهواز"},
        {"181", "آبادان"},
        {"182", "خرمشهر"},
        {"183", "ایذه"},
        {"184", "ایذه"},
        {"185", "بهبهان"},
        {"186", "بهبهان"},
        {"187", "شوشتر"},
        {"188", "شوشتر"},
        {"189", "شادگان"},
        {"190", "رامهرمز"},
        {"191", "رامهرمز"},
        {"192", "اندیمشک"},
        {"193", "اندیمشک"},
        {"194", "بندرماهشهر"},
        {"195", "بندرماهشهر"},
        {"196", "مسجدسلیمان"},
        {"197", "مسجدسلیمان"},
        {"198", "دشت آزادگان"},
        {"199", "دزفول"},
        {"200", "دزفول"},
        {"202", "گنبد کاووس"},
        {"203", "گنبد کاووس"},
        {"205", "بابل"},
        {"206", "بابل"},
        {"208", "ساری"},
        {"209", "ساری"},
        {"211", "گرگان"},
        {"212", "گرگان"},
        {"213", "آمل"},
        {"214", "آمل"},
        {"215", "قائمشهر"},
        {"216", "قائمشهر"},
        {"217", "بهشهر"},
        {"218", "بهشهر"},
        {"219", "نوشهر"},
        {"220", "نوشهر"},
        {"221", "تنکابن"},
        {"222", "نور"},
        {"223", "بندرترکمن"},
        {"224", "کردکوی"},
        {"225", "سوادکوه"},
        {"226", "علی آباد"},
        {"227", "رامسر"},
        {"228", "شیراز"},
        {"229", "شیراز"},
        {"230", "شیراز"},
        {"236", "کازرون"},
        {"237", "کازرون"},
        {"238", "ممسنی"},
        {"239", "ممسنی"},
        {"240", "آباده"},
        {"241", "آباده"},
        {"242", "مرودشت"},
        {"243", "مرودشت"},
        {"244", "فیروزآباد"},
        {"245", "فیروزآباد"},
        {"246", "جهرم"},
        {"247", "جهرم"},
        {"248", "داراب"},
        {"249", "داراب"},
        {"250", "لارستان"},
        {"251", "لارستان"},
        {"252", "استهبان"},
        {"253", "سپیدان"},
        {"255", "نی ریز"},
        {"256", "فسا"},
        {"257", "فسا"},
        {"258", "رشت"},
        {"259", "رشت"},
        {"261", "آستارا"},
        {"262", "طالش"},
        {"263", "طالش"},
        {"264", "بندرانزلی"},
        {"265", "رودبار"},
        {"266", "فومن"},
        {"267", "صومعه سرا"},
        {"268", "رودسر"},
        {"269", "رودسر"},
        {"270", "لنگرود"},
        {"271", "لاهیجان"},
        {"272", "لاهیجان"},
        {"273", "آستانه"},
        {"274", "ارومیه"},
        {"275", "ارومیه"},
        {"279", "خوی"},
        {"280", "خوی"},
        {"282", "ماکو"},
        {"283", "ماکو"},
        {"284", "سلماس"},
        {"285", "سلماس"},
        {"286", "مهاباد"},
        {"287", "مهاباد"},
        {"288", "مینودشت"},
        {"289", "پیرانشهر"},
        {"290", "نقده"},
        {"291", "سیه چشمه(چالدران)"},
        {"292", "بوکان"},
        {"293", "شاهین دژ"},
        {"294", "تکاب"},
        {"295", "اشنویه"},
        {"296", "میاندوآب"},
        {"297", "میاندوآب"},
        {"298", "کرمان"},
        {"299", "کرمان"},
        {"302", "جیرفت"},
        {"303", "جیرفت"},
        {"304", "رفسنجان"},
        {"305", "رفسنجان"},
        {"306", "سیرجان"},
        {"307", "سیرجان"},
        {"308", "زرند"},
        {"309", "زرند"},
        {"310", "بم"},
        {"311", "بم"},
        {"312", "بافت"},
        {"313", "بافت"},
        {"314", "شهربابک"},
        {"315", "کهنوج"},
        {"316", "کهنوج"},
        {"317", "بردسیر"},
        {"318", "گلباف"},
        {"319", "شهداد"},
        {"320", "فهرج"},
        {"321", "راور"},
        {"322", "پاوه"},
        {"323", "پاوه"},
        {"324", "کرمانشاه"},
        {"325", "کرمانشاه"},
        {"330", "کنگاور"},
        {"331", "هرسین"},
        {"332", "گیلانغرب"},
        {"333", "اسلام آباد"},
        {"334", "اسلام آباد"},
        {"335", "سنقر"},
        {"336", "سرپل ذهاب"},
        {"337", "قصرشیرین"},
        {"338", "بندرعباس"},
        {"339", "بندرعباس"},
        {"341", "میناب"},
        {"342", "میناب"},
        {"343", "بندرلنگه"},
        {"344", "بندرلنگه"},
        {"345", "قشم"},
        {"346", "جاسک"},
        {"347", "حاجی آباد هرمزگان"},
        {"348", "بستک"},
        {"349", "بوشهر"},
        {"350", "بوشهر"},
        {"351", "دشتستان"},
        {"352", "دشتستان"},
        {"353", "بندر گناوه"},
        {"354", "دشتی"},
        {"355", "تنگستان"},
        {"356", "کنگان"},
        {"357", "دیر"},
        {"358", "ایرانشهر"},
        {"359", "ایرانشهر"},
        {"361", "زاهدان"},
        {"362", "زاهدان"},
        {"364", "چابهار"},
        {"365", "چابهار"},
        {"366", "زابل"},
        {"367", "زابل"},
        {"369", "سراوان"},
        {"370", "سراوان"},
        {"371", "خاش"},
        {"372", "سنندج"},
        {"373", "سنندج"},
        {"375", "سقز"},
        {"376", "سقز"},
        {"377", "بیجار"},
        {"378", "بیجار"},
        {"379", "قروه"},
        {"380", "قروه"},
        {"381", "مریوان"},
        {"382", "مریوان"},
        {"383", "کامیاران"},
        {"384", "بانه"},
        {"385", "دیواندره"},
        {"386", "همدان"},
        {"387", "همدان"},
        {"392", "ملایر"},
        {"393", "ملایر"},
        {"394", "کرند"},
        {"395", "نهاوند"},
        {"396", "نهاوند"},
        {"397", "تویسرکان"},
        {"398", "رزن"},
        {"399", "رزن"},
        // Sorted
        {"400", "اسدآباد"},
        {"401", "اسدآباد"},
        {"402", "کبودرآهنگ"},
        {"403", "کبودرآهنگ"},
        {"404", "بهار"},
        {"405", "بهار"},
        {"406", "خرم آباد"},
        {"407", "خرم آباد"},
        {"412", "بروجرد"},
        {"413", "بروجرد"},
        {"416", "الیگودرز"},
        {"417", "الیگودرز"},
        {"418", "الشتر"},
        {"419", "کوهدشت"},
        {"420", "نورآباد(دلفان)"},
        {"421", "دورود"},
        {"422", "بویراحمد(یاسوج)"},
        {"423", "بویراحمد(یاسوج)"},
        {"424", "کهکیلویه(دهدشت)"},
        {"425", "کهکیلویه(دهدشت)"},
        {"426", "گچساران(دوگنبدان)"},
        {"427", "زنجان"},
        {"428", "زنجان"},
        {"431", "قزوین"},
        {"432", "قزوین"},
        {"438", "تاکستان"},
        {"439", "تاکستان"},
        {"442", "یزد"},
        {"443", "یزد"},
        {"444", "اردکان"},
        {"445", "تفت"},
        {"446", "مهریز"},
        {"447", "بافق"},
        {"448", "میبد"},
        {"449", "ایلام"},
        {"450", "ایلام"},
        {"451", "دهلران"},
        {"452", "مهران"},
        {"453", "شیروان و چرداول"},
        {"454", "آبدانان"},
        {"455", "دره شهر"},
        {"456", "سمنان"},
        {"457", "دامغان"},
        {"458", "شاهرود"},
        {"459", "شاهرود"},
        {"460", "گرمسار"},
        {"462", "شهرکرد"},
        {"461", "شهرکرد"},
        {"465", "بروجن"},
        {"466", "لردگان"},
        {"467", "فارسان"},
        {"468", "اردل"},
        {"469", "رودان"},
        {"470", "گاوبندی"},
        {"471", "امور خارجه"},
        {"472", "امور خارجه"},
        {"481", "باغ ملک"},
        {"483", "ازنا / چالوس"},
        {"484", "ازنا"},
        {"487", "رامیان"},
        {"489", "ساوجبلاغ"},
        {"490", "شهریار"},
        {"491", "شهریار"},
        {"492", "پلدشت"},
        {"493", "چایپاره"},
        {"494", "دالاهو"},
        {"495", "جوانرود"},
        {"496", "صحنه"},
        {"497", "آق قلا"},
        {"498", "بابل"},
        {"499", "نکاء"},
        {"500", "هراز و محمودآباد"},
        {"501", "هراز و محمودآباد"},
        {"502", "فامنین"},
        {"503", "ابرکوه"},
        {"504", "پارس آباد"},
        {"505", "جلفا"},
        {"506", "عجب شیر"},
        {"507", "ملکان"},
        {"508", "آبیک"},
        {"509", "بوئین زهرا"},
        {"510", "شاهین شهر"},
        {"511", "شاهین شهر"},
        {"512", "سمیرم سفلی (دهاقان)"},
        {"513", "بوانات"},
        {"514", "سروستان"},
        {"515", "لامرد"},
        {"516", "ماسال و شاندرمن"},
        {"517", "سیاهکل"},
        {"518", "خمام"},
        {"519", "کلیبر"},
        {"520", "میامی"},
        {"521", "جغتای"},
        {"522", "چناران"},
        {"523", "درمیان"},
        {"524", "مانه و سملقان"},
        {"525", "نیک شهر"},
        {"526", "شوش"},
        {"527", "آغاجاری"},
        {"528", "ویسیان"},
        {"529", "بندر دیلم"},
        {"530", "مهدیشهر"},
        {"531", "مراوه تپه"},
        {"532", "سعد آباد"},
        {"533", "شهرکی و ناروئی(زهک)"},
        {"534", "بدره"},
        {"535", "کوهبنان"},
        {"536", "رودبار کهنوج"},
        {"537", "فین"},
        {"538", "آوج"},
        {"540", "خور و بیابانک"},
        {"541", "مبارکه"},
        {"542", "انار"},
        {"543", "هرات و مروست"},
        {"544", "فراهان"},
        {"545", "ترکمانچای"},
        {"546", "بیضا"},
        {"547", "خشت و کمارج"},
        {"548", "خرامه"},
        {"549", "تیران و کرون"},
        {"550", "لنده"},
        {"551", "اشکذر"},
        {"552", "نیر"},
        {"553", "کلات"},
        {"554", "خمیر"},
        {"555", "کوهرنگ"},
        {"556", "اسلامشهر"},
        {"557", "اشترینان"},
        {"558", "دهگلان"},
        {"559", "ضیاءآباد"},
        {"561", "بهاباد"},
        {"562", "بجستان"},
        {"563", "نهبندان"},
        {"564", "جرقویه"},
        {"565", "کوهپایه"},
        {"566", "سنجبد(کوثر)"},
        {"567", "ورزقان"},
        {"568", "بندپی"},
        {"569", "شفت"},
        {"570", "رضوانشهر"},
        {"571", "وفس"},
        {"572", "بردسکن"},
        {"573", "جوین"},
        {"574", "زبرخان"},
        {"575", "چادگان"},
        {"576", "چهاردانگه"},
        {"577", "شیرگاه"},
        {"578", "دودانگه"},
        {"579", "گلوگاه"},
        {"580", "رودبار الموت"},
        {"581", "ارکوازی(ملکشاهی)"},
        {"582", "جویبار"},
        {"583", "رابر"},
        {"584", "قلقل رود"},
        {"585", "اروندکنار"},
        {"586", "بشاگرد"},
        {"588", "طارم سفلی"},
        {"590", "رودبار شهرستان"},
        {"591", "رازوجرکلان"},
        {"592", "پاپی"},
        {"593", "عمارلو"},
        {"595", "ثلاث باباجانی"},
        {"596", "روانسر"},
        {"597", "لاشار(اسپکه)"},
        {"598", "رومشکان"},
        {"599", "بهمنی"},
        {"600", "چاروسا"},
        {"601", "بیله سوار"},
        {"603", "نیر"},
        {"604", "هوراند"},
        {"605", "ریگان"},
        {"606", "عنبرآباد"},
        {"607", "ماهان"},
        {"608", "منوجان"},
        {"609", "جم"},
        {"611", "میرجاوه"},
        {"610", "شبانکاره"},
        {"612", "چغلوندی"},
        {"613", "چگنی"},
        {"615", "ابهر و خرمدره"},
        {"616", "ایوان"},
        {"617", "خنداب"},
        {"618", "زرند مرکزی"},
        {"619", "آران و بیدگل"},
        {"620", "باغ بهادران"},
        {"621", "بوئین و میاندشت"},
        {"622", "میمه"},
        {"623", "آزادشهر"},
        {"625", "چمستان"},
        {"626", "کجور"},
        {"627", "کلاردشت"},
        {"628", "گمیشان"},
        {"629", "گندمان"},
        {"630", "املش"},
        {"631", "رحیم آباد"},
        {"632", "فلارد"},
        {"633", "کیار"},
        {"634", "شیروان لومار"},
        {"635", "فاروج"},
        {"636", "چاروایماق"},
        {"637", "انزل"},
        {"638", "سیلوانه"},
        {"640", "شوط"},
        {"641", "حمیل"},
        {"642", "بیارجمند"},
        {"643", "احمدآباد"},
        {"644", "تخت جلگه"},
        {"646", "سروآباد"},
        {"647", "شراء و پیشخوار"},
        {"648", "ارسنجان"},
        {"649", "اوز"},
        {"650", "رشتخوار"},
        {"651", "فیض آباد"},
        {"652", "زیرکوه"},
        {"653", "سنگر"},
        {"654", "حاجی آباد(زرین دشت)"},
        {"655", "خفر"},
        {"656", "کراش"},
        {"657", "مهر"},
        {"658", "پاکدشت"},
        {"659", "فیروزکوه"},
        {"660", "دولت آباد"},
        {"661", "هندیجان"},
        {"662", "رامشیر"},
        {"663", "اندیکا"},
        {"664", "کهریزک"},
        {"665", "سعادت آباد"},
        {"666", "رباط کریم"},
        {"667", "ابوموسی"},
        {"668", "سیب و سوران"},
        {"669", "قصرقند"},
        {"670", "آباده طشک"},
        {"671", "جویم"},
        {"673", "شیبکوه"},
        {"674", "کرانی"},
        {"675", "کشاورز"},
        {"676", "نمشیر"},
        {"677", "تخت سلیمان"},
        {"678", "اشکنان"},
        {"679", "فراشبند"},
        {"680", "هویزه"},
        {"681", "قنقری(خرم بید)"},
        {"682", "بزمان"},
        {"683", "کوار"},
        {"684", "ایوانکی"},
        {"685", "امیدیه"},
        {"686", "نمین"},
        {"687", "باشت"},
        {"688", "دروهان"},
        {"689", "بندرگز"},
        {"690", "انگوت"},
        {"691", "باینگان"},
        {"692", "سردشت"},
        {"693", "کوچصفهان"},
        {"694", "لشت نشاء"},
        {"695", "طالقان"},
        {"696", "میانکوه"},
        {"697", "مارگون"},
        {"698", "قلعه گنج"},
        {"699", "فنوج"},
        {"700", "بسطام"},
        {"701", "دشتیاری"},
        {"702", "کهک"},
        {"703", "بمپور"},
        {"704", "زابلی"},
        {"705", "شیب آب"},
        {"706", "بندر امام خمینی"},
        {"707", "شاوور"},
        {"711", "بندپی شرقی"},
        {"712", "عباس آباد"},
        {"713", "میاندورود"},
        {"714", "خورش رستم"},
        {"715", "سرعین"},
        {"716", "سربیشه"},
        {"717", "نظرآباد"},
        {"718", "دستگردان"},
        {"719", "سرایان"},
        {"720", "راسک"},
        {"721", "بشرویه"},
        {"722", "ارزونیه"},
        {"723", "قیروکارزین"},
        {"724", "خلیل آباد"},
        {"725", "کنارک"},
        {"726", "زرین آباد"},
        {"727", "موسیان"},
        {"728", "البرز"},
        {"729", "گتوند"},
        {"730", "لالی"},
        {"731", "ارشق"},
        {"732", "دلوار"},
    };

    public static bool ValidationNationalCode(this string? nationalCode)
    {
        try
        {
            if (nationalCode.IsNotEmpty())
            {
                if (nationalCode!.Length == 10)
                {
                    if (nationalCode.ValidationCityNationalCode())
                    {
                        List<int> _nationalCode = nationalCode.ToCharArray().Reverse().Select(s => int.Parse(s.ToString())).ToList();
                        int sum = 0;
                        for (int i = 10; i > 1; i--)
                        {
                            sum += _nationalCode[i - 1] * i;
                        }
                        int remining = sum % 11;
                        return remining <= 1 ? _nationalCode[0] == remining : _nationalCode[0] == 11 - remining;
                    }
                }
            }
        }
        catch (Exception) { }

        return false;
    }

    public static bool ValidationCityNationalCode(this string nationalCode)
    {
        try
        {
            string cityCode = nationalCode[..3];
            return CityCodes.ContainsKey(cityCode);
        }
        catch (Exception) { }

        return false;
    }

    public static string GetCityNationalCode(this string nationalCode)
    {
        try
        {
            string cityCode = nationalCode[..3];
            if (CityCodes.ContainsKey(cityCode))
            {
                return CityCodes[cityCode];
            }
        }
        catch (Exception) { }

        return Resource.InvalidNationalCode;
    }
}